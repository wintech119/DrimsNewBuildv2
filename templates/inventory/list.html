{% extends 'base.html' %}

{% block title %}Inventory{% endblock %}

{% block content %}
<div class="page-container">
    <!-- Page Header -->
    <div class="page-header-modern">
        <div class="page-title-group">
            <h1>
                <i class="bi bi-boxes"></i>
                Inventory Summary
            </h1>
            <p class="subtitle">View and manage inventory across all warehouses</p>
        </div>
        <div class="d-flex gap-2">
            {% if has_feature('inventory_intake') %}
            <a href="{{ url_for('intake.list_intakes') }}" class="btn btn-modern btn-primary">
                <i class="bi bi-arrow-down-circle me-2"></i>
                Record Intake
            </a>
            {% endif %}
        </div>
    </div>

    <!-- Filter Bar -->
    <div class="filter-bar">
        <form method="GET" class="d-flex align-items-center gap-3">
            <label for="warehouse_id" class="form-label mb-0 font-semibold text-nowrap">
                <i class="bi bi-building me-1"></i>
                Warehouse:
            </label>
            <select class="form-control filter-select" name="warehouse_id" id="warehouse_id" onchange="this.form.submit()">
                <option value="">All Warehouses</option>
                {% for warehouse in warehouses %}
                <option value="{{ warehouse.warehouse_id }}" {% if selected_warehouse_id == warehouse.warehouse_id %}selected{% endif %}>
                    {{ warehouse.warehouse_name }}
                </option>
                {% endfor %}
            </select>
        </form>
    </div>

    <!-- Inventory Table -->
    {% if inventory_items %}
    <div class="table-container">
        <table class="modern-table">
            <thead>
                <tr>
                    <th>Warehouse</th>
                    <th>Item</th>
                    <th>SKU</th>
                    <th>Usable</th>
                    <th>Reserved</th>
                    <th>Defective</th>
                    <th>Expired</th>
                    <th>UOM</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for inv, item_name, sku_code, warehouse_name in inventory_items %}
                <tr>
                    <td>
                        <strong>{{ warehouse_name }}</strong>
                    </td>
                    <td>{{ item_name }}</td>
                    <td>
                        <code class="code-pill">{{ sku_code }}</code>
                    </td>
                    <td>
                        <strong class="text-success">{{ inv.usable_qty }}</strong>
                    </td>
                    <td>
                        <span class="text-warning">{{ inv.reserved_qty }}</span>
                    </td>
                    <td>
                        <span class="text-danger">{{ inv.defective_qty }}</span>
                    </td>
                    <td>
                        <span class="text-muted">{{ inv.expired_qty }}</span>
                    </td>
                    <td>{{ inv.uom_code }}</td>
                    <td>
                        <span class="status-badge status-badge-{{ inv.status_code|status_badge('inventory') }}">
                            {{ inv.status_code|status_label('inventory') }}
                        </span>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="empty-state">
        <i class="bi bi-boxes"></i>
        <h5>No Inventory Records</h5>
        <p>No inventory records found for the selected warehouse.</p>
        {% if has_feature('inventory_intake') %}
        <a href="{{ url_for('intake.list_intakes') }}" class="btn btn-modern btn-primary">
            <i class="bi bi-arrow-down-circle me-2"></i>
            Record Intake
        </a>
        {% endif %}
    </div>
    {% endif %}
</div>
{% endblock %}
