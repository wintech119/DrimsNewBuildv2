{# Batch Selection Drawer Component #}
{# Side drawer for selecting batches during package preparation #}

{# Overlay backdrop #}
<div class="batch-drawer-overlay" id="batchDrawerOverlay"></div>

{# Drawer container #}
<div class="batch-drawer" id="batchDrawer">
    {# Header #}
    <div class="batch-drawer-header">
        <button type="button" class="batch-drawer-close" id="batchDrawerClose" aria-label="Close">
            <i class="bi bi-x-lg"></i>
        </button>
        <h2 class="batch-drawer-title">Select Batches</h2>
        <p class="batch-drawer-subtitle" id="batchDrawerItemName">Choose batches for allocation</p>
    </div>

    {# Body #}
    <div class="batch-drawer-body">
        {# Request Summary #}
        <div class="batch-request-summary">
            <div class="batch-request-summary-grid">
                <div class="batch-summary-item">
                    <span class="batch-summary-label">Requested Quantity</span>
                    <span class="batch-summary-value" id="batchRequestedQty">0</span>
                </div>
                <div class="batch-summary-item">
                    <span class="batch-summary-label">Allocated Quantity</span>
                    <span class="batch-summary-value highlight" id="batchAllocatedQty">0</span>
                </div>
                <div class="batch-summary-item">
                    <span class="batch-summary-label">Remaining</span>
                    <span class="batch-summary-value warning" id="batchRemainingQty">0</span>
                </div>
                <div class="batch-summary-item">
                    <span class="batch-summary-label">Allocation Rule</span>
                    <span class="batch-summary-value" id="batchIssuanceOrder">FIFO</span>
                </div>
            </div>
        </div>


        {# Batch List #}
        <div id="batchListContainer">
            <h3 class="batch-list-header">Available Batches</h3>
            <div class="batch-list" id="batchList">
                {# Batches will be loaded here dynamically #}
            </div>
        </div>

        {# Empty State #}
        <div class="batch-empty-state" id="batchEmptyState" style="display: none;">
            <div class="batch-empty-state-icon">
                <i class="bi bi-inbox"></i>
            </div>
            <p class="batch-empty-state-text">No batches available for this item</p>
        </div>

        {# Loading State #}
        <div class="batch-loading" id="batchLoadingState" style="display: none;">
            <div class="batch-loading-spinner"></div>
        </div>
    </div>

    {# Footer #}
    <div class="batch-drawer-footer">
        <button type="button" class="batch-drawer-footer-btn secondary" id="batchDrawerCancel">
            Cancel
        </button>
        <button type="button" class="batch-drawer-footer-btn primary" id="batchDrawerApply">
            Apply Allocations
        </button>
    </div>
</div>

{# Batch Item Template (hidden, cloned by JavaScript) #}
<template id="batchItemTemplate">
    <div class="batch-item" data-batch-id="">
        <div class="batch-item-header">
            <div class="batch-item-main">
                <div class="batch-item-number">
                    <i class="bi bi-box-seam"></i>
                    <span class="batch-number"></span>
                </div>
                <div class="batch-item-warehouse">
                    <i class="bi bi-building"></i>
                    <span class="batch-warehouse-name"></span>
                </div>
            </div>
            <div class="batch-item-status-container">
                {# Status badge will be added here if needed #}
            </div>
        </div>

        <div class="batch-item-details">
            <div class="batch-detail-item">
                <span class="batch-detail-label">Batch Date</span>
                <span class="batch-detail-value batch-batch-date">-</span>
            </div>
            <div class="batch-detail-item">
                <span class="batch-detail-label">Expiry Date</span>
                <span class="batch-detail-value batch-expiry-date">-</span>
            </div>
            <div class="batch-detail-item">
                <span class="batch-detail-label">Available Quantity</span>
                <span class="batch-detail-value highlight batch-available-qty">0</span>
            </div>
            <div class="batch-detail-item">
                <span class="batch-detail-label">Size/UOM</span>
                <span class="batch-detail-value batch-size-uom">-</span>
            </div>
        </div>

        <div class="batch-allocation-input-group">
            <div class="batch-allocation-input-wrapper">
                <input 
                    type="number" 
                    class="batch-allocation-input" 
                    placeholder="Enter quantity" 
                    min="0" 
                    step="0.0001"
                    data-batch-allocation-input
                />
            </div>
            <button type="button" class="batch-allocation-max-btn" data-batch-max-btn>
                Use Max
            </button>
        </div>
    </div>
</template>
